-- Advance Server Finder GUI v4 - Clean + Final

local gui = Instance.new("ScreenGui")
gui.Name = "AdvanceServerUI"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.Parent = game:GetService("CoreGui")

-- Black background
local blackBG = Instance.new("Frame")
blackBG.Size = UDim2.new(1, 0, 1, 0)
blackBG.BackgroundColor3 = Color3.new(0, 0, 0)
blackBG.BorderSizePixel = 0
blackBG.Parent = gui

-- Main frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0.4, 0, 0.4, 0)
frame.Position = UDim2.new(0.3, 0, 0.3, 0)
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
frame.BorderSizePixel = 0
frame.Parent = blackBG
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 10)

-- Main label (status messages)
local label = Instance.new("TextLabel")
label.Size = UDim2.new(1, -20, 0.25, 0)
label.Position = UDim2.new(0, 10, 0, 10)
label.BackgroundTransparency = 1
label.TextColor3 = Color3.new(1, 1, 1)
label.Font = Enum.Font.SourceSansBold
label.TextScaled = true
label.TextWrapped = true
label.Text = "Initializing..."
label.Parent = frame

-- Progress % label
local percentLabel = Instance.new("TextLabel")
percentLabel.Size = UDim2.new(1, -20, 0.15, 0)
percentLabel.Position = UDim2.new(0, 10, 0.3, 10)
percentLabel.BackgroundTransparency = 1
percentLabel.TextColor3 = Color3.new(1, 1, 1)
percentLabel.Font = Enum.Font.SourceSans
percentLabel.TextScaled = true
percentLabel.Text = "Progress: 0%"
percentLabel.Parent = frame

-- Time remaining
local timeLabel = Instance.new("TextLabel")
timeLabel.Size = UDim2.new(1, -20, 0.15, 0)
timeLabel.Position = UDim2.new(0, 10, 0.45, 10)
timeLabel.BackgroundTransparency = 1
timeLabel.TextColor3 = Color3.new(1, 1, 1)
timeLabel.Font = Enum.Font.SourceSans
timeLabel.TextScaled = true
timeLabel.Text = "Estimated time left: 10:00"
timeLabel.Parent = frame

-- Progress bar
local progressBarBG = Instance.new("Frame")
progressBarBG.Size = UDim2.new(1, -40, 0.1, 0)
progressBarBG.Position = UDim2.new(0, 20, 0.63, 0)
progressBarBG.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
progressBarBG.BorderSizePixel = 0
progressBarBG.Parent = frame
Instance.new("UICorner", progressBarBG).CornerRadius = UDim.new(0, 6)

local progressFill = Instance.new("Frame")
progressFill.Size = UDim2.new(0, 0, 1, 0)
progressFill.Position = UDim2.new(0, 0, 0, 0)
progressFill.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
progressFill.BorderSizePixel = 0
progressFill.Parent = progressBarBG
Instance.new("UICorner", progressFill).CornerRadius = UDim.new(0, 6)

-- Pet label BELOW the loading bar
local petLabel = Instance.new("TextLabel")
petLabel.Size = UDim2.new(1, -20, 0.15, 0)
petLabel.Position = UDim2.new(0, 10, 0.78, 0)
petLabel.BackgroundTransparency = 1
petLabel.TextColor3 = Color3.new(1, 1, 1)
petLabel.Font = Enum.Font.SourceSansItalic
petLabel.TextScaled = true
petLabel.Text = ""
petLabel.Parent = frame

-- Sound
local sound = Instance.new("Sound", gui)
sound.SoundId = "rbxassetid://9118823106"
sound.Volume = 0.4
sound.Looped = true
sound:Play()

-- Time setup
local totalTime = 600
local startTime = tick()

-- Message cycling every 30s
local messages = {
    "Please wait...",
    "You are going to advance server soon...",
    "Finding the right server for you...",
    "Checking your credentials...",
    "Reading your logs..."
}

spawn(function()
    local msgIndex = 1
    while tick() - startTime < totalTime do
        label.Text = messages[msgIndex]
        msgIndex = msgIndex % #messages + 1
        wait(30)
    end
end)

-- Progress and timer
spawn(function()
    while tick() - startTime < totalTime do
        local elapsed = tick() - startTime
        local percent = math.floor((elapsed / totalTime) * 100)
        local remaining = math.max(0, totalTime - elapsed)
        local minutes = math.floor(remaining / 60)
        local seconds = math.floor(remaining % 60)

        percentLabel.Text = ("Progress: %d%%"):format(percent)
        timeLabel.Text = ("Estimated time left: %02d:%02d"):format(minutes, seconds)
        progressFill.Size = UDim2.new(percent / 100, 0, 1, 0)

        wait(0.5)
    end
end)

-- Pet scanning (1 minute each)
local pets = { "Raccoon", "Dragonfly", "Butterfly", "Queen Bee", "Disco Bee", "Mimic Octopus" }
spawn(function()
    for _, pet in ipairs(pets) do
        petLabel.Text = "Finding pets: " .. pet .. "..."
        wait(60)
        petLabel.Text = "Finding pets: " .. pet .. " âœ…"
        wait(1)
    end
end)

-- End screen
delay(totalTime, function()
    sound:Stop()
    frame:Destroy()

    local resultText = Instance.new("TextLabel")
    resultText.Size = UDim2.new(1, 0, 1, 0)
    resultText.Position = UDim2.new(0, 0, 0, 0)
    resultText.BackgroundTransparency = 1
    resultText.TextColor3 = Color3.new(1, 0, 0)
    resultText.Font = Enum.Font.SourceSansBold
    resultText.TextScaled = true
    resultText.Text = "Server not found"
    resultText.Parent = blackBG

    wait(3)
    resultText.Text = "Account not qualified"
    wait(3)
    resultText.Text = "Required pets not found"
end)
